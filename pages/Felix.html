<html>
  <head>
    <title>Felix Meritis | Living Future AR</title>
    <link rel="icon" type="image/x-icon" href="../favicon.ico">
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="../js/aframe-render-order-component.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <script src="../js/aframe-look-at-component.min.js"></script>
    <script src="../js/aframe-extras.min.js"></script>
    <style>
      body {
        margin: 0px 0px 0px 0px !important;
        width: 100% !important;
        height: 100% !important;
      }
      .frame {
        width: 100%;
        height: 81%;
        border: none;
      }
      .header{
        width: 100%;
        height: 10%;
        background-color: black;
        border-bottom: 0.5px solid white;
        display: flex;
      }
      .left {
        height: 100%;
        width: 80%;
        position: relative;
      }
      .right {
        height: 100%;
        width: 20%;
        position: relative; 
      }
      #logo {
        height: auto;
        max-height: 40px;
        width: 90%;
        margin: 0;
        position: absolute;
        top: 50%;
        left: 50%;
        -ms-transform: translate(-50%, -50%);
        transform: translate(-50%, -50%);
      }
      #back {
        height: auto;
        max-height: 40px;
        width: 75%;
        margin: 0;
        position: absolute;
        top: 50%;
        left: 50%;
        -ms-transform: translate(-50%, -50%);
        transform: translate(-50%, -50%);
      }
      #back-text {
        color: white;
        font-family: Helvetica, Sans-Serif;
        font-size: 22px;
      }
      .footer {
        width: 100%;
        height: 9%;
        background-color: black;
        position: relative;
      }
      #music-button {
        height: 70%;
        width: auto;
        margin: 0;
        margin-left: 20px;
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
      }
      #invest-button {
        height: 70%;
        width: 220px;
        right: 20px;
        margin: 0;
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background-color: black;
        color: white;
        font-family: Helvetica, Sans-Serif;
        font-size: 16px;
        border: 2px solid white;
        border-radius: 15px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <script>
      AFRAME.registerComponent('add-objects', {
      init: function() {
        let thisMesh = this.el.getObject3D('mesh')

        let boxGeometry = new THREE.BoxGeometry(30, 1.5, 30);

        let boxMaterial = new THREE.MeshBasicMaterial({
          color: "#FF00FF"
        })
        let mesh = new THREE.Mesh(boxGeometry, boxMaterial)

        var group = new THREE.Group();

        group.add(mesh)
        thisMesh.add(group)
      }
    })

    AFRAME.registerComponent('cloak', {
      init: function() {
        let mesh = this.el.getObject3D('mesh')
        if (mesh !== undefined) {
          mesh.traverse(function(node) {
            if (node.isMesh) {
              if (node.material) {
                node.material.colorWrite = false
                node.material.needsUpdate = true;
              }
            }
          });
        }
      }
    })
    </script>
    <div class="header">
      <div class="left"><img id="logo" src="../images/LF-Logo.svg" alt="Living Future"></div>
      <div class="right"><input id="back" type="image" onclick="location.href='../index.html';" src="../images/Back-BTN.svg" /></div>
    </div>
    <div class="frame">
      <a-scene
        embedded
        style="height: 100%;"
        renderer="sortObjects: true;"
        vr-mode-ui="enabled: false"
        arjs='sourceType: webcam; videoTexture: true; debugUIEnabled: false;'
        loading-screen="dotsColor: white; backgroundColor: black">

            <a-asset>
                <a-asset-item id="spinning-orb" src="../models/Spinning-Orb.gltf"></a-asset-item>
                <a-asset-item id="arrow-obj" src="../models/Pointer.obj"></a-asset-item>
                <a-asset-item id="arrow-mtl" src="../models/Pointer.mtl"></a-asset-item>
            </a-asset>

            <a-camera look-controls-enabled="false" arjs-look-controls="smoothingFactor: 0.1" gps-projected-camera rotation-reader></a-camera>
            <a-entity id="music-visualiser" gltf-model="#spinning-orb" gps-projected-entity-place="latitude: 52.32140122831929; longitude: -1.9735346939476313;" light="type: ambient; intensity: 2;" position="0 2 0" scale="1 1 1" animation-mixer></a-entity>
            <!--<a-obj-model id="arrow-entity" gps-projected-entity-place="latitude: 52.32140122831929; longitude: -1.9735346939476313;" src="#arrow-obj" mtl="#arrow-mtl" position="0 5 0" scale="0.01 0.01 0.01"></a-obj-model>--->
            <!--<a-box gps-projected-entity-place='latitude: 52.32140122831929; longitude: -1.9735346939476313;' material='color: red' scale='2 2 2' position="0 5 0"></a-box>--->
        </a-scene>
    </div>
    <div class="footer">
      <!--<button id="music-button">Play Music</button>--->
      <input id="music-button" type="image" src="../images/Mute-Icon.svg" />
      <button id="invest-button"><p style="white-space:pre; margin-top: 7%;">I N V E S T   N O W !</p></button>
    </div>
  </body>
  <script>
    var playingMusic = false;
    document.querySelector('#music-button').addEventListener('click', function (evt) {
      console.log('play music mk II');
      var entity = document.querySelector('#music-visualiser');
      if (playingMusic == false) {
        entity.components.sound.playSound();

        console.log(playingMusic);
        //entity.components.animation-mixer.startFrame(0);
        //entity.components.setAttribute('animation-mixer', {startFrame: 0});
        //console.log(entity.components['animation-mixer']);
        entity.setAttribute('animation-mixer','clip: stop;');
        entity.setAttribute('animation-mixer','clip: *;');
        //entity.components['animation-mixer'].setTime(0);
        document.getElementById("music-button").src="../images/Play-Icon.svg";
        playingMusic = true;
      } else {
        entity.components.sound.stopSound();
        console.log(playingMusic);
        document.getElementById("music-button").src="../images/Mute-Icon.svg";
        playingMusic = false;
      }
    });
  </script>
</html>
